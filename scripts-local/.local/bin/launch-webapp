#!/bin/bash
# Launch a web application in the default browser
# Usage: launch-webapp <url>

if [[ -z $1 ]]; then
  echo "Usage: launch-webapp <url>"
  exit 1
fi

url="$1"

# Ensure URL has protocol
if [[ ! $url =~ ^https?:// ]]; then
  url="https://$url"
fi

# Get default browser
default_browser=$(xdg-settings get default-web-browser 2>/dev/null)

if [[ -z $default_browser ]]; then
  browser_exec="chromium"
else
  browser_exec=$(sed -n 's/^Exec=\([^ ]*\).*/\1/p' \
    {~/.local,/usr}/share/applications/$default_browser 2>/dev/null | head -1)
fi

exec $browser_exec "$url" &
